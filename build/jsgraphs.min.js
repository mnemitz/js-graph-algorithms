"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FordFulkerson=exports.TopologicalSortShortestPaths=exports.BellmanFord=exports.Dijkstra=exports.EagerPrimMST=exports.LazyPrimMST=exports.KruskalMST=exports.StronglyConnectedComponents=exports.TopologicalSort=exports.ConnectedComponents=exports.BreadthFirstSearch=exports.DepthFirstSearch=exports.FlowNetwork=exports.FlowEdge=exports.WeightedDiGraph=exports.WeightedGraph=exports.Edge=exports.DiGraph=exports.Graph=exports.IndexMinPQ=exports.QuickUnion=exports.MinPQ=exports.Queue=exports.QueueNode=exports.Stack=exports.StackNode=void 0;var less=function(t,e,i){return i(t,e)<0},exchange=function(t,e,i){var s=t[e];t[e]=t[i],t[i]=s},StackNode=function(t){this.value=t,this.next=null};exports.StackNode=StackNode;var Stack=function(){this.N=0,this.first=null};(exports.Stack=Stack).prototype.push=function(t){this.first=this._push(this.first,t)},Stack.prototype._push=function(t,e){if(null==t)return this.N++,new StackNode(e);var i=t;return this.N++,(t=new StackNode(e)).next=i,t},Stack.prototype.pop=function(){if(null!=this.first){var t=this.first,e=t.value;return this.first=t.next,this.N--,e}},Stack.prototype.size=function(){return this.N},Stack.prototype.isEmpty=function(){return 0==this.N},Stack.prototype.peep=function(){if(null!=this.first)return this.first.value},Stack.prototype.toArray=function(){for(var t=[],e=this.first;null!=e;)t.push(e.value),e=e.next;return t};var QueueNode=function(t){this.value=t,this.next=null};exports.QueueNode=QueueNode;var Queue=function(){this.first=null,this.last=null,this.N=0};(exports.Queue=Queue).prototype.enqueue=function(t){var e=this.last;this.last=new QueueNode(t),null!=e&&(e.next=this.last),null==this.first&&(this.first=this.last),this.N++},Queue.prototype.dequeue=function(){if(null!=this.first){var t=this.first,e=t.value;return this.first=t.next,null==this.first&&(this.last=null),this.N--,e}},Queue.prototype.size=function(){return this.N},Queue.prototype.isEmpty=function(){return 0==this.N},Queue.prototype.toArray=function(){for(var t=[],e=this.first;null!=e;)t.push(e.value),e=e.next;return t};var MinPQ=function(t){this.s=[],this.N=0,t||(t=function(t,e){return t-e}),this.compare=t};(exports.MinPQ=MinPQ).prototype.enqueue=function(t){for(;this.s.lengh<=this.N+1;)this.s.push(0);this.s[++this.N]=t,this.swim(this.N)},MinPQ.prototype.swim=function(t){for(;1<t;){var e=Math.floor(t/2);if(!less(this.s[t],this.s[e],this.compare))break;exchange(this.s,t,e),t=e}},MinPQ.prototype.delMin=function(){if(0!=this.N){var t=this.s[1];return exchange(this.s,1,this.N--),this.sink(1),t}},MinPQ.prototype.sink=function(t){for(;2*t<=this.N;){var e=2*t;if(e<this.N&&less(this.s[e+1],this.s[e],this.compare)&&e++,!less(this.s[e],this.s[t],this.compare))break;exchange(this.s,e,t),t=e}},MinPQ.prototype.size=function(){return this.N},MinPQ.prototype.isEmpty=function(){return 0==this.N};var QuickUnion=function(t){this.id=[];for(var e=0;e<t;++e)this.id.push(e)};(exports.QuickUnion=QuickUnion).prototype.union=function(t,e){var i=this.root(t),s=this.root(e);s!=i&&(this.id[s]=i)},QuickUnion.prototype.root=function(t){for(;this.id[t]!=t;)t=this.id[t];return t},QuickUnion.prototype.connected=function(t,e){return this.root(t)==this.root(e)};var IndexMinPQ=function(t,e){this.keys=[],this.pq=[],this.qp=[];for(var i=0;i<=t;++i)this.keys.push(null),this.pq.push(0),this.qp.push(-1);this.N=0,e||(e=function(t,e){return t-e}),this.compare=e};(exports.IndexMinPQ=IndexMinPQ).prototype.insert=function(t,e){this.keys[t]=e,this.pq[++this.N]=t,this.qp[t]=this.N,this.swim(this.N)},IndexMinPQ.prototype.decreaseKey=function(t,e){less(e,this.keys[t],this.compare)&&(this.keys[t]=e,this.swim(this.qp[t]))},IndexMinPQ.prototype.minKey=function(){return this.keys[this.pq[1]]},IndexMinPQ.prototype.min=function(){return this.pq[1]},IndexMinPQ.prototype.delMin=function(){var t=this.pq[1];return exchange(this.pq,1,this.N),this.qp[this.pq[1]]=1,this.qp[this.pq[this.N]]=-1,this.keys[this.pq[this.N]]=null,this.N--,this.sink(1),t},IndexMinPQ.prototype.swim=function(t){for(;1<t;){var e=Math.floor(t/2);if(!less(this.keys[this.pq[t]],this.keys[this.pq[e]],this.compare))break;exchange(this.pq,t,e),this.qp[this.pq[t]]=t,t=this.qp[this.pq[e]]=e}},IndexMinPQ.prototype.sink=function(t){for(;2*t<=this.N;){var e=2*t;if(e<this.N&&less(this.keys[this.pq[e+1]],this.keys[this.pq[e]],this.compare)&&e++,!less(this.keys[this.pq[e]],this.keys[this.pq[t]],this.compare))break;exchange(this.pq,t,e),this.qp[this.pq[t]]=t,t=this.qp[this.pq[e]]=e}},IndexMinPQ.prototype.containsIndex=function(t){return-1!=this.qp[t]},IndexMinPQ.prototype.isEmpty=function(){return 0==this.N},IndexMinPQ.prototype.size=function(){return this.N};var Graph=function(t){this.V=t,this.adjList=[],this.nodeInfo=[],this.edges={};for(var e=0;e<t;++e)this.adjList.push([]),this.nodeInfo.push({})};(exports.Graph=Graph).prototype.addEdge=function(t,e){this.adjList[t].push(e),this.adjList[e].push(t);var i=t+"_"+e;e<t&&(i=e+"_"+t),this.edges[i]=new Edge(t,e,0)},Graph.prototype.adj=function(t){return this.adjList[t]},Graph.prototype.node=function(t){return this.nodeInfo[t]},Graph.prototype.edge=function(t,e){var i=t+"_"+e;return e<t&&(i=e+"_"+t),i in this.edges?this.edges[i]:null};var DiGraph=function(t){this.V=t,this.adjList=[],this.nodeInfo=[],this.edges={};for(var e=0;e<t;++e)this.adjList.push([]),this.nodeInfo.push({})};(exports.DiGraph=DiGraph).prototype.addEdge=function(t,e){this.adjList[t].push(e);var i=t+"_"+e;this.edges[i]=new Edge(t,e,0)},DiGraph.prototype.edge=function(t,e){var i=t+"_"+e;return i in this.edges?this.edges[i]:null},DiGraph.prototype.adj=function(t){return this.adjList[t]},DiGraph.prototype.node=function(t){return this.nodeInfo[t]},DiGraph.prototype.reverse=function(){for(var t=new DiGraph(this.V),e=0;e<this.V;++e)for(var i=this.adjList[e],s=0;s<i.length;++s){var r=i[s];t.addEdge(r,e)}return t};var Edge=function(t,e,i){this.v=t,this.w=e,this.weight=i};(exports.Edge=Edge).prototype.either=function(){return this.v},Edge.prototype.other=function(t){return t==this.v?this.w:this.v},Edge.prototype.from=function(){return this.v},Edge.prototype.to=function(){return this.w};var WeightedGraph=function(t){this.V=t,this.adjList=[],this.nodeInfo=[];for(var e=0;e<t;++e)this.adjList.push([]),this.nodeInfo.push({})};(exports.WeightedGraph=WeightedGraph).prototype.adj=function(t){return this.adjList[t]},WeightedGraph.prototype.edge=function(t,e){for(var i=this.adjList[t],s=0;s<i.length;++s){if(i[s].other(t)==e)return i[s]}return null},WeightedGraph.prototype.node=function(t){return this.nodeInfo[t]},WeightedGraph.prototype.addEdge=function(t){var e=t.either(),i=t.other(e);this.adjList[e].push(t),this.adjList[i].push(t)};var WeightedDiGraph=function(t){WeightedGraph.call(this,t)};(exports.WeightedDiGraph=WeightedDiGraph).prototype=Object.create(WeightedGraph.prototype),WeightedDiGraph.prototype.addEdge=function(t){var e=t.from();this.adjList[e].push(t)},WeightedDiGraph.prototype.edge=function(t,e){for(var i=this.adjList[t],s=0;s<i.length;++s){if(i[s].other(t)==e)return i[s]}return null},WeightedDiGraph.prototype.toDiGraph=function(){for(var t=new DiGraph(this.V),e=0;e<this.V;++e)for(var i=this.adjList[e],s=0;s<i.length;++s){var r=i[s].other(e);t.addEdge(e,r)}return t};var FlowEdge=function(t,e,i){this.v=t,this.w=e,this.capacity=i,this.flow=0};(exports.FlowEdge=FlowEdge).prototype.residualCapacityTo=function(t){return t==this.v?this.flow:this.capacity-this.flow},FlowEdge.prototype.addResidualFlowTo=function(t,e){t==this.v?this.flow-=e:t==this.w&&(this.flow+=e)},FlowEdge.prototype.from=function(){return this.v},FlowEdge.prototype.to=function(){return this.w},FlowEdge.prototype.other=function(t){return t==this.v?this.w:this.v};var FlowNetwork=function(t){this.V=t,this.adjList=[],this.nodeInfo=[];for(var e=0;e<t;++e)this.adjList.push([]),this.nodeInfo.push({})};(exports.FlowNetwork=FlowNetwork).prototype.node=function(t){return this.nodeInfo[t]},FlowNetwork.prototype.edge=function(t,e){for(var i=this.adjList[t],s=0;s<i.length;++s){if(i[s].other(t)==e)return i[s]}return null},FlowNetwork.prototype.addEdge=function(t){var e=t.from();this.adjList[e].push(t);var i=t.other(e);this.adjList[i].push(t)},FlowNetwork.prototype.adj=function(t){return this.adjList[t]};var DepthFirstSearch=function(t,e){this.s=e;var i=t.V;this.marked=[],this.edgeTo=[];for(var s=0;s<i;++s)this.marked.push(!1),this.edgeTo.push(-1);this.dfs(t,e)};(exports.DepthFirstSearch=DepthFirstSearch).prototype.dfs=function(t,e){this.marked[e]=!0;for(var i=t.adj(e),s=0;s<i.length;++s){var r=i[s];this.marked[r]||(this.edgeTo[r]=e,this.dfs(t,r))}},DepthFirstSearch.prototype.hasPathTo=function(t){return this.marked[t]},DepthFirstSearch.prototype.pathTo=function(t){var e=new Stack;if(t==this.s)return[t];for(var i=t;i!=this.s;i=this.edgeTo[i])e.push(i);return e.push(this.s),e.toArray()};var BreadthFirstSearch=function(t,e){var i=t.V;this.s=e;var s=new Queue;s.enqueue(e),this.marked=[],this.edgeTo=[];for(var r=0;r<i;++r)this.marked.push(!1),this.edgeTo.push(-1);for(;!s.isEmpty();){r=s.dequeue();this.marked[r]=!0;for(var o=t.adj(r),h=0;h<o.length;++h){var n=o[h];this.marked[n]||(this.edgeTo[n]=r,s.enqueue(n))}}};(exports.BreadthFirstSearch=BreadthFirstSearch).prototype.hasPathTo=function(t){return this.marked[t]},BreadthFirstSearch.prototype.pathTo=function(t){var e=new Stack;if(t==this.s)return[t];for(var i=t;i!=this.s;i=this.edgeTo[i])e.push(i);return e.push(this.s),e.toArray()};var ConnectedComponents=function(t){this.count=0;var e=t.V;this.marked=[],this.id=[];for(var i=0;i<e;++i)this.marked.push(!1),this.id.push(-1);for(i=0;i<e;++i)this.marked[i]||(this.dfs(t,i),this.count++)};(exports.ConnectedComponents=ConnectedComponents).prototype.dfs=function(t,e){this.marked[e]=!0,this.id[e]=this.count;for(var i=t.adj(e),s=0;s<i.length;++s){var r=i[s];this.marked[r]||this.dfs(t,r)}},ConnectedComponents.prototype.componentId=function(t){return this.id[t]},ConnectedComponents.prototype.componentCount=function(){return this.count};var TopologicalSort=function(t){this.postOrder=new Stack,this.marked=[];for(var e=t.V,i=0;i<e;++i)this.marked.push(!1);for(i=0;i<e;++i)this.marked[i]||this.dfs(t,i)};(exports.TopologicalSort=TopologicalSort).prototype.dfs=function(t,e){this.marked[e]=!0;for(var i=t.adj(e),s=0;s<i.length;++s){var r=i[s];this.marked[r]||this.dfs(t,r)}this.postOrder.push(e)},TopologicalSort.prototype.order=function(){return this.postOrder.toArray()};var StronglyConnectedComponents=function(t){var e=t.V;this.count=0,this.marked=[],this.id=[];for(var i=0;i<e;++i)this.marked.push(!1),this.id.push(-1);for(var s=new TopologicalSort(t.reverse()).order(),r=0;r<s.length;++r){i=s[r];this.marked[i]||(this.dfs(t,i),this.count++)}};(exports.StronglyConnectedComponents=StronglyConnectedComponents).prototype.dfs=function(t,e){this.marked[e]=!0,this.id[e]=this.count;for(var i=t.adj(e),s=0;s<i.length;++s){var r=i[s];this.marked[r]||this.dfs(t,r)}},StronglyConnectedComponents.prototype.componentId=function(t){return this.id[t]},StronglyConnectedComponents.prototype.componentCount=function(){return this.count};var KruskalMST=function(t){for(var e=t.V,i=new MinPQ(function(t,e){return t.weight-e.weight}),s=0;s<t.V;++s)for(var r=t.adj(s),o=0;o<r.length;++o){(n=r[o]).either()==s&&i.enqueue(n)}this.mst=[];for(var h=new QuickUnion(e);!i.isEmpty()&&this.mst.length<e-1;){s=(n=i.delMin()).either();var n,a=n.other(s);h.connected(s,a)||(h.union(s,a),this.mst.push(n))}};exports.KruskalMST=KruskalMST;var LazyPrimMST=function(t){var e=t.V;this.marked=[];for(var i=0;i<e;++i)this.marked.push(!1);for(this.pq=new MinPQ(function(t,e){return t.weight-e.weight}),this.mst=[],this.visit(t,0);!this.pq.isEmpty()&&this.mst.length<e-1;){var s=this.pq.delMin(),r=(i=s.either(),s.other(i));this.marked[i]&&this.marked[r]||(this.mst.push(s),this.marked[i]||this.visit(t,i),this.marked[r]||this.visit(t,r))}};(exports.LazyPrimMST=LazyPrimMST).prototype.visit=function(t,e){this.marked[e]=!0;for(var i=t.adj(e),s=0;s<i.length;++s){var r=i[s];this.marked[r.other(e)]||this.pq.enqueue(r)}};var EagerPrimMST=function(t){var e=t.V;this.pq=new IndexMinPQ(e,function(t,e){return t.weight-e.weight}),this.marked=[];for(var i=0;i<e;++i)this.marked.push(!1);for(this.mst=[],this.visit(t,0);!this.pq.isEmpty();){var s=this.pq.minKey(),r=this.pq.delMin();this.mst.push(s),this.marked[r]||this.visit(t,r)}};(exports.EagerPrimMST=EagerPrimMST).prototype.visit=function(t,e){this.marked[e]=!0;for(var i=t.adj(e),s=0;s<i.length;++s){var r=i[s],o=r.other(e);this.marked[o]||(this.pq.containsIndex(o)?this.pq.decreaseKey(o,r):this.pq.insert(o,r))}};var Dijkstra=function(t,e){var i=t.V;this.s=e,this.marked=[],this.edgeTo=[],this.cost=[],this.pq=new IndexMinPQ(i,function(t,e){return e});for(var s=0;s<i;++s)this.marked.push(!1),this.edgeTo.push(null),this.cost.push(Number.MAX_VALUE);for(this.cost[e]=0,this.pq.insert(e,this.cost[e]);!this.pq.isEmpty();){s=this.pq.delMin();this.marked[s]=!0;for(var r=t.adj(s),o=0;o<r.length;++o){var h=r[o];this.relax(h)}}};(exports.Dijkstra=Dijkstra).prototype.relax=function(t){var e=t.from(),i=t.to();this.cost[i]>this.cost[e]+t.weight&&(this.cost[i]=this.cost[e]+t.weight,this.edgeTo[i]=t,this.pq.containsIndex(i)?this.pq.decreaseKey(i,this.cost[i]):this.pq.insert(i,this.cost[i]))},Dijkstra.prototype.hasPathTo=function(t){return this.marked[t]},Dijkstra.prototype.pathTo=function(t){for(var e=new Stack,i=t;i!=this.s;i=this.edgeTo[i].other(i))e.push(this.edgeTo[i]);return e.toArray()},Dijkstra.prototype.distanceTo=function(t){return this.cost[t]};var BellmanFord=function(t,e){var i=t.V;this.s=e,this.marked=[],this.edgeTo=[],this.cost=[];for(var s=0;s<i;++s)this.marked.push(!1),this.edgeTo.push(null),this.cost.push(Number.MAX_VALUE);this.cost[e]=0,this.marked[e]=!0;for(var r=0;r<i;++r)for(s=0;s<i;++s)for(var o=t.adj(s),h=0;h<o.length;++h){var n=o[h];this.relax(n)}};(exports.BellmanFord=BellmanFord).prototype.relax=function(t){var e=t.from(),i=t.to();this.cost[i]>this.cost[e]+t.weight&&(this.cost[i]=this.cost[e]+t.weight,this.marked[i]=!0,this.edgeTo[i]=t)},BellmanFord.prototype.hasPathTo=function(t){return this.marked[t]},BellmanFord.prototype.pathTo=function(t){for(var e=new Stack,i=t;i!=this.s;i=this.edgeTo[i].other(i))e.push(this.edgeTo[i]);return e.toArray()},BellmanFord.prototype.distanceTo=function(t){return this.cost[t]};var TopologicalSortShortestPaths=function(t,e){var i=t.V;this.s=e,this.marked=[],this.edgeTo=[],this.cost=[];for(var s=0;s<i;++s)this.marked.push(!1),this.edgeTo.push(null),this.cost.push(Number.MAX_VALUE);this.cost[e]=0,this.marked[e]=!0;for(var r=new TopologicalSort(t.toDiGraph()).order(),o=0;o<r.length;++o){s=r[o];for(var h=t.adj(s),n=0;n<h.length;++n){var a=h[n];this.relax(a)}}};(exports.TopologicalSortShortestPaths=TopologicalSortShortestPaths).prototype.relax=function(t){var e=t.from(),i=t.to();this.cost[i]>this.cost[e]+t.weight&&(this.cost[i]=this.cost[e]+t.weight,this.marked[i]=!0,this.edgeTo[i]=t)},TopologicalSortShortestPaths.prototype.hasPathTo=function(t){return this.marked[t]},TopologicalSortShortestPaths.prototype.pathTo=function(t){for(var e=new Stack,i=t;i!=this.s;i=this.edgeTo[i].other(i))e.push(this.edgeTo[i]);return e.toArray()},TopologicalSortShortestPaths.prototype.distanceTo=function(t){return this.cost[t]};var FordFulkerson=function(t,e,i){this.value=0;t.V;var s=Number.MAX_VALUE;for(this.marked=null,this.edgeTo=null,this.s=e,this.t=i;this.hasAugmentedPath(t);){for(var r=this.t;r!=this.s;r=this.edgeTo[r].other(r))s=Math.min(s,this.edgeTo[r].residualCapacityTo(r));for(r=this.t;r!=this.s;r=this.edgeTo[r].other(r))this.edgeTo[r].addResidualFlowTo(r,s);this.value+=s}};(exports.FordFulkerson=FordFulkerson).prototype.hasAugmentedPath=function(t){var e=t.V;this.marked=[],this.edgeTo=[];for(var i=0;i<e;++i)this.marked.push(!1),this.edgeTo.push(null);var s=new Queue;for(s.enqueue(this.s),this.marked[this.s]=!0;!s.isEmpty();){i=s.dequeue();for(var r=t.adj(i),o=0;o<r.length;++o){var h=r[o],n=h.other(i);if(!this.marked[n]&&0<h.residualCapacityTo(n)){if(this.edgeTo[n]=h,this.marked[n]=!0,n==this.t)return!0;s.enqueue(n)}}}return!1},FordFulkerson.prototype.minCut=function(t){for(var e=[],i=t.V,s=0;s<i;++s)for(var r=t.adj(s),o=0;o<r.length;++o){var h=r[o];h.from()==s&&0==h.residualCapacityTo(h.other(s))&&e.push(h)}return e};